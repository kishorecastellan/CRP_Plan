<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LPPM Rentals - Complete Technical Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
            padding: 2rem;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 3rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            color: #1a1a1a;
            border-bottom: 3px solid #2563eb;
            padding-bottom: 1rem;
        }

        h2 {
            font-size: 2rem;
            margin-top: 3rem;
            margin-bottom: 1rem;
            color: #1e40af;
            border-left: 4px solid #3b82f6;
            padding-left: 1rem;
            page-break-before: always;
        }

        h3 {
            font-size: 1.5rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
            color: #1e3a8a;
        }

        h4 {
            font-size: 1.25rem;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            color: #1e40af;
        }

        p {
            margin-bottom: 1rem;
            color: #4b5563;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            background: white;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        th,
        td {
            padding: 0.75rem 1rem;
            text-align: left;
            border: 1px solid #e5e7eb;
        }

        th {
            background: #f3f4f6;
            font-weight: 600;
            color: #1f2937;
            text-transform: uppercase;
            font-size: 0.875rem;
            letter-spacing: 0.5px;
        }

        tr:nth-child(even) {
            background: #f9fafb;
        }

        tr:hover {
            background: #f3f4f6;
        }

        .check {
            color: #10b981;
            font-weight: bold;
        }

        .cross {
            color: #ef4444;
            font-weight: bold;
        }

        code {
            background: #f3f4f6;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.9em;
            color: #dc2626;
        }

        pre {
            background: #1f2937;
            color: #f9fafb;
            padding: 1.5rem;
            border-radius: 6px;
            overflow-x: auto;
            margin: 1rem 0;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.875rem;
            line-height: 1.5;
        }

        pre code {
            background: transparent;
            color: inherit;
            padding: 0;
        }

        .schema-section {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .schema-section h4 {
            margin-top: 0;
            color: #1e40af;
            border-bottom: 2px solid #3b82f6;
            padding-bottom: 0.5rem;
        }

        .field-group {
            margin: 1rem 0;
        }

        .field-group h5 {
            color: #4b5563;
            font-size: 1rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .field-list {
            background: white;
            border-left: 3px solid #3b82f6;
            padding: 0.75rem 1rem;
            margin: 0.5rem 0;
        }

        .field-list ul {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .field-list li {
            padding: 0.25rem 0;
            color: #374151;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.875rem;
        }

        .field-list li strong {
            color: #1f2937;
        }

        .note-box {
            background: #dbeafe;
            border-left: 4px solid #3b82f6;
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .warning-box {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        ul,
        ol {
            margin: 1rem 0 1rem 2rem;
        }

        li {
            margin-bottom: 0.5rem;
            color: #4b5563;
        }

        strong {
            color: #1f2937;
        }

        .header {
            text-align: center;
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 2px solid #e5e7eb;
        }

        .subtitle {
            color: #6b7280;
            font-size: 1.25rem;
            margin-top: 0.5rem;
        }

        .toc {
            background: #f9fafb;
            padding: 1.5rem;
            border-radius: 6px;
            margin: 2rem 0;
        }

        .toc h3 {
            margin-top: 0;
            color: #1f2937;
        }

        .toc ul {
            list-style: none;
            margin-left: 0;
        }

        .toc li {
            margin-bottom: 0.5rem;
        }

        .toc a {
            color: #2563eb;
            text-decoration: none;
        }

        .toc a:hover {
            text-decoration: underline;
        }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.875rem;
            font-weight: 600;
            margin-right: 0.5rem;
        }

        .badge-admin {
            background: #dbeafe;
            color: #1e40af;
        }

        .badge-agent {
            background: #d1fae5;
            color: #065f46;
        }

        .badge-applicant {
            background: #fef3c7;
            color: #92400e;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }

            .container {
                box-shadow: none;
                padding: 1rem;
            }

            h2 {
                page-break-before: always;
            }

            table,
            .schema-section {
                page-break-inside: avoid;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>LPPM Rentals SaaS</h1>
            <p class="subtitle">Complete Technical Documentation</p>
            <p style="color: #9ca3af; font-size: 0.875rem;">Version 1.0 | Last Updated: February 3, 2026</p>
        </div>

        <div class="toc">
            <h3>Table of Contents</h3>
            <ul>
                <li><a href="#roles">1. Role/Permission Matrix</a></li>
                <li><a href="#schemas">2. Database Schemas (DynamoDB)</a></li>
                <li><a href="#api">3. API Documentation</a></li>
                <li><a href="#build">4. Build & Deployment Configuration</a></li>
                <li><a href="#services">5. Third-Party Services & Scripts</a></li>

            </ul>
        </div>

        <h2 id="roles">1. Role/Permission Matrix</h2>

        <h3>User Roles</h3>
        <table>
            <thead>
                <tr>
                    <th>Role</th>
                    <th>Description</th>
                    <th>Access Level</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="badge badge-admin">Admin</span></td>
                    <td>Property managers and system administrators</td>
                    <td>Full system access</td>
                </tr>
                <tr>
                    <td><span class="badge badge-agent">Agent</span></td>
                    <td>Real estate agents with referral capabilities</td>
                    <td>Limited to referrals and active listings</td>
                </tr>
                <tr>
                    <td><span class="badge badge-applicant">Applicant</span></td>
                    <td>Primary rental applicants</td>
                    <td>Own applications and documents</td>
                </tr>
                <tr>
                    <td><strong>Co-Applicant</strong></td>
                    <td>Joint applicants linked to primary application</td>
                    <td>Linked application access only</td>
                </tr>
                <tr>
                    <td><strong>Guarantor</strong></td>
                    <td>Financial guarantors for applicants</td>
                    <td>Linked application access only</td>
                </tr>
            </tbody>
        </table>

        <h3>Permission Matrix</h3>
        <table>
            <thead>
                <tr>
                    <th>Feature/Route</th>
                    <th>Admin</th>
                    <th>Agent</th>
                    <th>Applicant</th>
                    <th>Co-Applicant</th>
                    <th>Guarantor</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td colspan="6" style="background: #f3f4f6; font-weight: bold;">Dashboard</td>
                </tr>
                <tr>
                    <td><code>/admin</code></td>
                    <td class="check">✅</td>
                    <td class="cross">❌</td>
                    <td class="cross">❌</td>
                    <td class="cross">❌</td>
                    <td class="cross">❌</td>
                </tr>
                <tr>
                    <td><code>/dashboard</code></td>
                    <td class="check">✅</td>
                    <td class="check">✅</td>
                    <td class="check">✅</td>
                    <td class="check">✅</td>
                    <td class="check">✅</td>
                </tr>
                <tr>
                    <td colspan="6" style="background: #f3f4f6; font-weight: bold;">Applications</td>
                </tr>
                <tr>
                    <td>View All Applications</td>
                    <td class="check">✅</td>
                    <td class="cross">❌</td>
                    <td class="cross">❌</td>
                    <td class="cross">❌</td>
                    <td class="cross">❌</td>
                </tr>
                <tr>
                    <td>View Own Application</td>
                    <td class="check">✅</td>
                    <td class="cross">❌</td>
                    <td class="check">✅</td>
                    <td class="check">✅</td>
                    <td class="check">✅</td>
                </tr>
                <tr>
                    <td>Create Application</td>
                    <td class="check">✅</td>
                    <td class="cross">❌</td>
                    <td class="check">✅</td>
                    <td class="cross">❌</td>
                    <td class="cross">❌</td>
                </tr>
                <tr>
                    <td>Edit Application</td>
                    <td class="check">✅</td>
                    <td class="cross">❌</td>
                    <td class="check">✅</td>
                    <td class="check">✅</td>
                    <td class="check">✅</td>
                </tr>
                <tr>
                    <td>Approve Application</td>
                    <td class="check">✅</td>
                    <td class="cross">❌</td>
                    <td class="cross">❌</td>
                    <td class="cross">❌</td>
                    <td class="cross">❌</td>
                </tr>
                <tr>
                    <td colspan="6" style="background: #f3f4f6; font-weight: bold;">Documents</td>
                </tr>
                <tr>
                    <td>Upload Documents</td>
                    <td class="check">✅</td>
                    <td class="cross">❌</td>
                    <td class="check">✅</td>
                    <td class="check">✅</td>
                    <td class="check">✅</td>
                </tr>
                <tr>
                    <td>View Own Documents</td>
                    <td class="check">✅</td>
                    <td class="cross">❌</td>
                    <td class="check">✅</td>
                    <td class="check">✅</td>
                    <td class="check">✅</td>
                </tr>
                <tr>
                    <td>View All Documents</td>
                    <td class="check">✅</td>
                    <td class="cross">❌</td>
                    <td class="cross">❌</td>
                    <td class="cross">❌</td>
                    <td class="cross">❌</td>
                </tr>
                <tr>
                    <td colspan="6" style="background: #f3f4f6; font-weight: bold;">Payments</td>
                </tr>
                <tr>
                    <td>Pay Application Fee</td>
                    <td class="check">✅</td>
                    <td class="cross">❌</td>
                    <td class="check">✅</td>
                    <td class="check">✅</td>
                    <td class="check">✅</td>
                </tr>
                <tr>
                    <td colspan="6" style="background: #f3f4f6; font-weight: bold;">Verification</td>
                </tr>
                <tr>
                    <td>Truv Income Verification</td>
                    <td class="check">✅</td>
                    <td class="cross">❌</td>
                    <td class="check">✅</td>
                    <td class="check">✅</td>
                    <td class="check">✅</td>
                </tr>
                <tr>
                    <td>Truv Asset Verification</td>
                    <td class="check">✅</td>
                    <td class="cross">❌</td>
                    <td class="check">✅</td>
                    <td class="check">✅</td>
                    <td class="check">✅</td>
                </tr>
                <tr>
                    <td colspan="6" style="background: #f3f4f6; font-weight: bold;">Properties</td>
                </tr>
                <tr>
                    <td>View Active Listings</td>
                    <td class="check">✅</td>
                    <td class="check">✅</td>
                    <td class="check">✅</td>
                    <td class="check">✅</td>
                    <td class="check">✅</td>
                </tr>
                <tr>
                    <td>Manage Properties</td>
                    <td class="check">✅</td>
                    <td class="cross">❌</td>
                    <td class="cross">❌</td>
                    <td class="cross">❌</td>
                    <td class="cross">❌</td>
                </tr>
            </tbody>
        </table>

        <h3>Role-Based Routes</h3>
        <pre><code>const DEFAULT_ROLE_ROUTES = {
  admin: '/admin',
  agent: '/listings/active',
  applicant: '/applications',
  coapplicant: '/playground/co-applicant',
  guarantor: '/playground/guarantor',
  default: '/dashboard'
}</code></pre>

        <h3>Test Accounts</h3>
        <div class="warning-box">
            <strong>⚠️ Note:</strong> Test accounts should be created in your development/staging environment only.
        </div>

        <table>
            <thead>
                <tr>
                    <th>Role</th>
                    <th>Email</th>
                    <th>Password</th>
                    <th>Purpose</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="badge badge-admin">Admin</span></td>
                    <td><code>admin@lppm.com</code></td>
                    <td><code>Adminny@2026</code></td>
                    <td>Full system testing</td>
                </tr>
                <tr>
                    <td><span class="badge badge-agent">Agent</span></td>
                    <td><code>agent@lppm.com</code></td>
                    <td><code>Agent@2026</code></td>
                    <td>Referral and listing testing</td>
                </tr>
                <tr>
                    <td><span class="badge badge-applicant">Applicant</span></td>
                    <td><code>applicant@lppm.com</code></td>
                    <td><code>Applicant@2026</code></td>
                    <td>Application flow testing</td>
                </tr>
                <tr>
                    <td><strong>Co-Applicant</strong></td>
                    <td><code>coapplicant@lppm.com</code></td>
                    <td><code>Coapplicant@2026</code></td>
                    <td>Joint application testing</td>
                </tr>
                <tr>
                    <td><strong>Guarantor</strong></td>
                    <td><code>guarantor@lppm.com</code></td>
                    <td><code>Guarantor@2026</code></td>
                    <td>Guarantor flow testing</td>
                </tr>
            </tbody>
        </table>

        <h2 id="schemas">2. Database Schemas (DynamoDB)</h2>
        <p>All data models are defined in <code>amplify/data/resource.ts</code> using AWS Amplify Gen 2 schema
            definition.</p>

        <div class="note-box">
            <strong>Authorization:</strong> All models use a combination of authenticated user access and public API key
            for flexibility. Each model has specific permissions for create, read, update, and delete operations.
        </div>

        <!-- APPLICATION SCHEMA -->
        <div class="schema-section" id="application">
            <h4>2.1 Application Schema</h4>
            <p><strong>Table Name:</strong> <code>Application</code></p>
            <p><strong>Primary Key:</strong> <code>userId</code> (Partition Key) + <code>application_id</code> (Sort
                Key)</p>
            <p><strong>Purpose:</strong> Stores primary applicant rental application data</p>

            <div class="field-group">
                <h5>Identifiers</h5>
                <div class="field-list">
                    <ul>
                        <li><strong>userId:</strong> string (required) - User ID from Cognito</li>
                        <li><strong>application_id:</strong> string (required) - Unique application identifier</li>
                        <li><strong>role:</strong> string - User role (backward compatibility)</li>
                    </ul>
                </div>
            </div>

            <div class="field-group">
                <h5>Application Details</h5>
                <div class="field-list">
                    <ul>
                        <li><strong>apartmentNumber:</strong> string</li>
                        <li><strong>apartmentType:</strong> string</li>
                        <li><strong>buildingAddress:</strong> string</li>
                        <li><strong>monthlyRent:</strong> integer</li>
                        <li><strong>moveInDate:</strong> string</li>
                        <li><strong>howDidYouHear:</strong> string</li>
                        <li><strong>howDidYouHearOther:</strong> string</li>
                    </ul>
                </div>
            </div>

            <div class="field-group">
                <h5>Applicant Personal Information</h5>
                <div class="field-list">
                    <ul>
                        <li><strong>applicantName:</strong> string</li>
                        <li><strong>applicantDob:</strong> string</li>
                        <li><strong>applicantAge:</strong> integer</li>
                        <li><strong>applicantSsn:</strong> string</li>
                        <li><strong>applicantPhone:</strong> string</li>
                        <li><strong>applicantEmail:</strong> string</li>
                        <li><strong>applicantAddress:</strong> string</li>
                        <li><strong>applicantCity:</strong> string</li>
                        <li><strong>applicantState:</strong> string</li>
                        <li><strong>applicantZip:</strong> string</li>
                        <li><strong>applicantLicense:</strong> string</li>
                        <li><strong>applicantLicenseState:</strong> string</li>
                        <li><strong>lengthAtAddressYears:</strong> integer</li>
                        <li><strong>lengthAtAddressMonths:</strong> integer</li>
                    </ul>
                </div>
            </div>

            <div class="field-group">
                <h5>Landlord Information</h5>
                <div class="field-list">
                    <ul>
                        <li><strong>landlordName:</strong> string</li>
                        <li><strong>landlordAddressLine1:</strong> string</li>
                        <li><strong>landlordAddressLine2:</strong> string</li>
                        <li><strong>landlordCity:</strong> string</li>
                        <li><strong>landlordState:</strong> string</li>
                        <li><strong>landlordZipCode:</strong> string</li>
                        <li><strong>landlordPhone:</strong> string</li>
                        <li><strong>landlordEmail:</strong> string</li>
                        <li><strong>currentRent:</strong> integer</li>
                        <li><strong>reasonForMoving:</strong> string</li>
                    </ul>
                </div>
            </div>

            <div class="field-group">
                <h5>Employment & Income</h5>
                <div class="field-list">
                    <ul>
                        <li><strong>employmentType:</strong> string</li>
                        <li><strong>employer:</strong> string</li>
                        <li><strong>position:</strong> string</li>
                        <li><strong>employmentStart:</strong> string</li>
                        <li><strong>businessName:</strong> string</li>
                        <li><strong>businessType:</strong> string</li>
                        <li><strong>yearsInBusiness:</strong> string</li>
                        <li><strong>income:</strong> string</li>
                        <li><strong>incomeFrequency:</strong> string</li>
                        <li><strong>otherIncome:</strong> string</li>
                        <li><strong>otherIncomeFrequency:</strong> string</li>
                        <li><strong>otherIncomeSource:</strong> string</li>
                        <li><strong>creditScore:</strong> string</li>
                    </ul>
                </div>
            </div>

            <div class="field-group">
                <h5>Truv Integration (Income)</h5>
                <div class="field-list">
                    <ul>
                        <li><strong>truvIncomeShareUrl:</strong> string</li>
                        <li><strong>truvIncomeBridgeToken:</strong> string</li>
                        <li><strong>truvIncomeAccountId:</strong> string</li>
                        <li><strong>truvIncomeCreatedAt:</strong> string</li>
                        <li><strong>truvIncomePdfUrl:</strong> string</li>
                        <li><strong>truvIncomeOrderId:</strong> string</li>
                        <li><strong>truvIncomeUserId:</strong> string</li>
                        <li><strong>truvIncomeLinkId:</strong> string</li>
                    </ul>
                </div>
            </div>

            <div class="field-group">
                <h5>Truv Integration (Assets)</h5>
                <div class="field-list">
                    <ul>
                        <li><strong>truvAssetsShareUrl:</strong> string</li>
                        <li><strong>truvAssetsBridgeToken:</strong> string</li>
                        <li><strong>truvAssetsAccountId:</strong> string</li>
                        <li><strong>truvAssetsCreatedAt:</strong> string</li>
                        <li><strong>truvAssetsPdfUrl:</strong> string</li>
                        <li><strong>truvAssetsOrderId:</strong> string</li>
                        <li><strong>truvAssetsUserId:</strong> string</li>
                        <li><strong>truvAssetsLinkId:</strong> string</li>
                    </ul>
                </div>
            </div>

            <div class="field-group">
                <h5>Complex Data (JSON)</h5>
                <div class="field-list">
                    <ul>
                        <li><strong>bankRecords:</strong> json - Bank account information</li>
                        <li><strong>documents:</strong> json - Uploaded document references</li>
                        <li><strong>occupants:</strong> json - Additional occupants</li>
                        <li><strong>additionalPeople:</strong> json - Other people in application</li>
                        <li><strong>signatures:</strong> json - Digital signatures</li>
                        <li><strong>payment:</strong> json - Payment information (Stripe)</li>
                    </ul>
                </div>
            </div>

            <div class="field-group">
                <h5>Application Flags</h5>
                <div class="field-list">
                    <ul>
                        <li><strong>hasCoApplicant:</strong> boolean</li>
                        <li><strong>hasGuarantor:</strong> boolean</li>
                        <li><strong>numberOfCoApplicants:</strong> integer</li>
                        <li><strong>numberOfGuarantors:</strong> integer</li>
                    </ul>
                </div>
            </div>

            <div class="field-group">
                <h5>Status & Tracking</h5>
                <div class="field-list">
                    <ul>
                        <li><strong>currentStep:</strong> string - Current step in application flow</li>
                        <li><strong>status:</strong> string - Application status</li>
                        <li><strong>leasePdfUrl:</strong> string - Generated lease PDF URL</li>
                        <li><strong>leasePdfS3Key:</strong> string - S3 key for lease PDF</li>
                        <li><strong>createdAt:</strong> datetime</li>
                        <li><strong>updatedAt:</strong> datetime</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- CO-APPLICANT SCHEMA -->
        <div class="schema-section" id="coapplicant">
            <h4>2.2 Co-Applicant Schema</h4>
            <p><strong>Table Name:</strong> <code>CoApplicant</code></p>
            <p><strong>Primary Key:</strong> <code>userId</code> (Partition Key) + <code>coApplicantId</code> (Sort Key)
            </p>
            <p><strong>Purpose:</strong> Stores co-applicant data linked to main application</p>
            <p><em>Contains similar fields to Application schema for personal info, employment, income, Truv
                    integration, and status tracking.</em></p>
        </div>

        <!-- GUARANTOR SCHEMA -->
        <div class="schema-section" id="guarantor">
            <h4>2.3 Guarantor Schema</h4>
            <p><strong>Table Name:</strong> <code>Guarantor</code></p>
            <p><strong>Primary Key:</strong> <code>userId</code> (Partition Key) + <code>guarantorId</code> (Sort Key)
            </p>
            <p><strong>Purpose:</strong> Stores guarantor data for applications requiring financial backing</p>
            <p><em>Contains similar fields to Application schema for personal info, employment, income, Truv
                    integration, and status tracking.</em></p>
        </div>

        <!-- TRUV TRACKING SCHEMA -->
        <div class="schema-section" id="truv">
            <h4>2.4 Truv Tracking Schema</h4>
            <p><strong>Table Name:</strong> <code>Truv</code></p>
            <p><strong>Primary Key:</strong> <code>product</code> (Partition Key) + <code>order_id</code> (Sort Key)</p>
            <p><strong>Purpose:</strong> Maps Truv order IDs to link IDs for webhook tracking</p>

            <div class="field-group">
                <h5>Key Fields</h5>
                <div class="field-list">
                    <ul>
                        <li><strong>product:</strong> string (required) - 'income' or 'asset'</li>
                        <li><strong>order_id:</strong> string (required) - Truv order ID</li>
                        <li><strong>link_id:</strong> string - Truv link ID (from webhook)</li>
                        <li><strong>userId:</strong> string - Application owner</li>
                        <li><strong>application_id:</strong> string - Associated application</li>
                        <li><strong>user_type:</strong> string - 'applicant', 'co-applicant', 'guarantor'</li>
                        <li><strong>status:</strong> string - 'pending', 'completed', 'failed'</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- INVITE SCHEMA -->
        <div class="schema-section" id="invite">
            <h4>2.5 Invite Schema</h4>
            <p><strong>Table Name:</strong> <code>Invite</code></p>
            <p><strong>Purpose:</strong> Tracks agent referral invitations</p>

            <div class="field-group">
                <h5>Fields</h5>
                <div class="field-list">
                    <ul>
                        <li><strong>email:</strong> string (required) - Invitee email</li>
                        <li><strong>agentEmail:</strong> string - Referring agent email</li>
                        <li><strong>agentName:</strong> string - Referring agent name</li>
                        <li><strong>listingId:</strong> string - Associated listing</li>
                        <li><strong>status:</strong> string - Invite status</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- PAYMENT SCHEMA -->
        <div class="schema-section" id="payment">
            <h4>2.6 Payment Schema</h4>
            <p><strong>Table Name:</strong> <code>Payment</code></p>
            <p><strong>Primary Key:</strong> <code>userId</code> (Partition Key) + <code>applicationId</code> (Sort Key)
            </p>
            <p><strong>Purpose:</strong> Tracks Stripe payment transactions</p>

            <div class="field-group">
                <h5>Fields</h5>
                <div class="field-list">
                    <ul>
                        <li><strong>userId:</strong> string (required)</li>
                        <li><strong>applicationId:</strong> string (required)</li>
                        <li><strong>stripeEventType:</strong> string - Stripe webhook event type</li>
                        <li><strong>amount:</strong> integer - Payment amount in cents</li>
                        <li><strong>currency:</strong> string - Currency code (e.g., 'usd')</li>
                        <li><strong>status:</strong> string - Payment status</li>
                    </ul>
                </div>
            </div>
        </div>

        <h2 id="api">3. API Documentation</h2>

        <h3>GraphQL Schema (AWS AppSync)</h3>
        <p>The application uses AWS Amplify Gen 2 with GraphQL API via AppSync. All schemas are auto-generated from the
            models defined in <code>amplify/data/resource.ts</code>.</p>

        <h3>REST API Endpoints</h3>
        <p>All API routes are located in <code>/app/api/</code></p>

        <h4>Authentication</h4>
        <table>
            <thead>
                <tr>
                    <th>Method</th>
                    <th>Endpoint</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>POST</strong></td>
                    <td><code>/api/auth/signin</code></td>
                    <td>User login</td>
                </tr>
                <tr>
                    <td><strong>POST</strong></td>
                    <td><code>/api/auth/signup</code></td>
                    <td>User registration</td>
                </tr>
                <tr>
                    <td><strong>POST</strong></td>
                    <td><code>/api/auth/signout</code></td>
                    <td>User logout</td>
                </tr>
                <tr>
                    <td><strong>POST</strong></td>
                    <td><code>/api/auth/refresh</code></td>
                    <td>Refresh auth tokens</td>
                </tr>
                <tr>
                    <td><strong>GET</strong></td>
                    <td><code>/api/auth/me</code></td>
                    <td>Get current user info</td>
                </tr>
            </tbody>
        </table>

        <h4>Applications</h4>
        <table>
            <thead>
                <tr>
                    <th>Method</th>
                    <th>Endpoint</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>POST</strong></td>
                    <td><code>/api/applications/save</code></td>
                    <td>Save/update application</td>
                </tr>
                <tr>
                    <td><strong>POST</strong></td>
                    <td><code>/api/approve-application</code></td>
                    <td>Approve application (admin only)</td>
                </tr>
            </tbody>
        </table>

        <h4>Documents (S3)</h4>
        <table>
            <thead>
                <tr>
                    <th>Method</th>
                    <th>Endpoint</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>POST</strong></td>
                    <td><code>/api/s3/upload-url</code></td>
                    <td>Get pre-signed upload URL</td>
                </tr>
                <tr>
                    <td><strong>POST</strong></td>
                    <td><code>/api/s3/download-url</code></td>
                    <td>Get pre-signed download URL</td>
                </tr>
                <tr>
                    <td><strong>DELETE</strong></td>
                    <td><code>/api/s3/delete</code></td>
                    <td>Delete document from S3</td>
                </tr>
            </tbody>
        </table>

        <h4>Payments (Stripe)</h4>
        <table>
            <thead>
                <tr>
                    <th>Method</th>
                    <th>Endpoint</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>POST</strong></td>
                    <td><code>/api/stripe/create-checkout-session</code></td>
                    <td>Create payment session</td>
                </tr>
                <tr>
                    <td><strong>POST</strong></td>
                    <td><code>/api/stripe/verify-payment</code></td>
                    <td>Verify payment status</td>
                </tr>
                <tr>
                    <td><strong>POST</strong></td>
                    <td><code>/api/stripe/webhook</code></td>
                    <td>Stripe webhook handler</td>
                </tr>
            </tbody>
        </table>

        <h4>Verification (Truv)</h4>
        <table>
            <thead>
                <tr>
                    <th>Method</th>
                    <th>Endpoint</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>POST</strong></td>
                    <td><code>/api/truv/income-verification</code></td>
                    <td>Initiate income verification</td>
                </tr>
                <tr>
                    <td><strong>GET</strong></td>
                    <td><code>/api/truv/income-report</code></td>
                    <td>Get income report</td>
                </tr>
                <tr>
                    <td><strong>GET</strong></td>
                    <td><code>/api/truv/assets-report</code></td>
                    <td>Get assets report</td>
                </tr>
                <tr>
                    <td><strong>POST</strong></td>
                    <td><code>/api/webhooks/truv-orders</code></td>
                    <td>Truv webhook handler</td>
                </tr>
            </tbody>
        </table>

        <h4>Admin Operations</h4>
        <table>
            <thead>
                <tr>
                    <th>Method</th>
                    <th>Endpoint</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>GET</strong></td>
                    <td><code>/api/admin/applications</code></td>
                    <td>List all applications</td>
                </tr>
                <tr>
                    <td><strong>GET</strong></td>
                    <td><code>/api/admin/properties</code></td>
                    <td>List all properties</td>
                </tr>
                <tr>
                    <td><strong>GET</strong></td>
                    <td><code>/api/admin/agents</code></td>
                    <td>List all agents</td>
                </tr>
                <tr>
                    <td><strong>POST</strong></td>
                    <td><code>/api/admin/create-agent</code></td>
                    <td>Create new agent</td>
                </tr>
            </tbody>
        </table>

        <h2 id="build">4. Build & Deployment Configuration</h2>

        <h3>Environment</h3>
        <table>
            <thead>
                <tr>
                    <th>Component</th>
                    <th>Version/Value</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Node.js</strong></td>
                    <td><code>v24.10.0</code></td>
                </tr>
                <tr>
                    <td><strong>Package Manager</strong></td>
                    <td><code>npm</code></td>
                </tr>
                <tr>
                    <td><strong>Lockfile</strong></td>
                    <td><code>package-lock.json</code></td>
                </tr>
                <tr>
                    <td><strong>Framework</strong></td>
                    <td>Next.js 14.2.10</td>
                </tr>
            </tbody>
        </table>

        <h3>Build Commands</h3>
        <pre><code># Development
npm run dev

# Production Build
npm run build</code></pre>

        <h3>Build & Deployment Summary</h3>
        <table>
            <thead>
                <tr>
                    <th>Configuration</th>
                    <th>Value</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Node Version</strong></td>
                    <td><code>v24.10.0</code></td>
                    <td>Runtime environment version</td>
                </tr>
                <tr>
                    <td><strong>Package Manager</strong></td>
                    <td><code>npm</code></td>
                    <td>Dependency management tool</td>
                </tr>
                <tr>
                    <td><strong>Lockfile</strong></td>
                    <td><code>package-lock.json</code></td>
                    <td>Dependency version lock</td>
                </tr>
                <tr>
                    <td><strong>Build Command</strong></td>
                    <td><code>npm run build</code></td>
                    <td>Production build command</td>
                </tr>
                <tr>
                    <td><strong>Deployment Target</strong></td>
                    <td><code>AWS Amplify Hosting</code></td>
                    <td>Git-based CI/CD platform</td>
                </tr>
            </tbody>
        </table>

        <h3>Deployment Target</h3>
        <div class="note-box">
            <strong>Platform:</strong> AWS Amplify Hosting<br>
            <strong>Method:</strong> Git-based CI/CD
        </div>

        <h3>Required Environment Variables</h3>
        <pre><code># AWS Amplify (Auto-configured)
AMPLIFY_REGION
USER_POOL_ID
USER_POOL_CLIENT_ID

# Stripe
STRIPE_SECRET_KEY
STRIPE_PUBLISHABLE_KEY
STRIPE_WEBHOOK_SECRET

# Truv
TRUV_CLIENT_ID
TRUV_ACCESS_SECRET

# Encryption
ENCRYPTION_KEY</code></pre>

        <h3>Package Configuration (package.json)</h3>
        <pre><code>{
  "name": "aws-amplify-gen2",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint",
    "generate-key": "node scripts/generate-encryption-key.js"
  },
  "dependencies": {
    "@aws-amplify/adapter-nextjs": "^1.6.12",
    "@aws-amplify/ui-react": "^6.5.5",
    "@aws-sdk/client-cognito-identity-provider": "^3.947.0",
    "@aws-sdk/client-dynamodb": "^3.913.0",
    "@aws-sdk/lib-dynamodb": "^3.913.0",
    "@aws-sdk/s3-request-presigner": "^3.980.0",
    "@dnd-kit/core": "^6.3.1",
    "@dnd-kit/modifiers": "^9.0.0",
    "@dnd-kit/sortable": "^10.0.0",
    "@dnd-kit/utilities": "^3.2.2",
    "@hookform/resolvers": "^5.2.2",
    "@radix-ui/react-avatar": "^1.1.10",
    "@radix-ui/react-checkbox": "^1.3.3",
    "@radix-ui/react-collapsible": "^1.1.12",
    "@radix-ui/react-dialog": "^1.1.15",
    "@radix-ui/react-dropdown-menu": "^2.1.16",
    "@radix-ui/react-label": "^2.1.7",
    "@radix-ui/react-popover": "^1.1.15",
    "@radix-ui/react-scroll-area": "^1.2.10",
    "@radix-ui/react-select": "^2.2.6",
    "@radix-ui/react-separator": "^1.1.7",
    "@radix-ui/react-slot": "^1.2.3",
    "@radix-ui/react-tabs": "^1.1.13",
    "@radix-ui/react-tooltip": "^1.2.8",
    "@stripe/react-stripe-js": "^5.4.1",
    "@stripe/stripe-js": "^8.6.1",
    "@tabler/icons-react": "^3.35.0",
    "@tailwindcss/postcss": "^4.1.14",
    "@tanstack/react-table": "^8.21.3",
    "@types/crypto-js": "^4.2.2",
    "@types/react-signature-canvas": "^1.0.7",
    "amazon-cognito-identity-js": "^6.3.15",
    "aws-amplify": "^6.6.6",
    "aws-jwt-verify": "^5.1.1",
    "class-variance-authority": "^0.7.1",
    "clsx": "^2.1.1",
    "crypto-js": "^4.2.0",
    "date-fns": "^4.1.0",
    "docx-pdf": "^0.0.1",
    "docx-templates": "^4.15.0",
    "docxtemplater": "^3.67.6",
    "input-otp": "^1.4.2",
    "libreoffice-convert": "^1.7.0",
    "lucide-react": "^0.546.0",
    "mammoth": "^1.11.0",
    "next": "14.2.10",
    "pizzip": "^3.2.0",
    "postcss": "^8.5.6",
    "puppeteer": "^24.34.0",
    "react": "^18",
    "react-day-picker": "^9.11.1",
    "react-dom": "^18",
    "react-hook-form": "^7.65.0",
    "react-markdown": "^10.1.0",
    "react-signature-canvas": "^1.1.0-alpha.2",
    "recharts": "^3.3.0",
    "sonner": "^2.0.7",
    "stripe": "^17.7.0",
    "tailwind-merge": "^3.3.1",
    "tailwindcss": "^4.1.14",
    "vaul": "^1.1.2",
    "zod": "^3.25.17"
  },
  "devDependencies": {
    "@aws-amplify/backend": "^1.5.1",
    "@aws-amplify/backend-cli": "^1.3.0",
    "@types/node": "^20",
    "@types/react": "^18",
    "@types/react-dom": "^18",
    "aws-cdk": "^2",
    "aws-cdk-lib": "^2",
    "constructs": "^10.3.0",
    "esbuild": "^0.23.1",
    "tsx": "^4.19.0",
    "tw-animate-css": "^1.4.0",
    "typescript": "^5.6.2"
  }
}</code></pre>

        <h3>Dependency Lock File (package-lock.json)</h3>
        <div class="note-box">
            <strong>Note:</strong> The <code>package-lock.json</code> file is automatically generated by npm and
            contains the exact dependency tree installed in <code>node_modules</code>. This file ensures consistent
            installations across different environments and should be committed to version control.
            <br><br>
            <strong>Key Information:</strong>
            <ul style="margin-top: 0.5rem;">
                <li><strong>Lock File Version:</strong> 3 (npm v7+)</li>
                <li><strong>Total Packages:</strong> Includes all direct and transitive dependencies</li>
                <li><strong>Purpose:</strong> Guarantees reproducible builds by locking exact versions</li>
                <li><strong>Location:</strong> <code>/package-lock.json</code> (root directory)</li>
            </ul>
        </div>

        <h2 id="services">5. Third-Party Services & Scripts</h2>

        <h3>External Services</h3>
        <table>
            <thead>
                <tr>
                    <th>Service</th>
                    <th>Purpose</th>
                    <th>Integration Type</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>AWS Amplify</strong></td>
                    <td>Backend infrastructure, hosting, CI/CD</td>
                    <td>Native</td>
                </tr>
                <tr>
                    <td><strong>AWS Cognito</strong></td>
                    <td>User authentication & authorization</td>
                    <td>AWS SDK</td>
                </tr>
                <tr>
                    <td><strong>AWS AppSync</strong></td>
                    <td>GraphQL API layer</td>
                    <td>Amplify Gen 2</td>
                </tr>
                <tr>
                    <td><strong>AWS DynamoDB</strong></td>
                    <td>NoSQL database</td>
                    <td>AWS SDK</td>
                </tr>
                <tr>
                    <td><strong>AWS S3</strong></td>
                    <td>File storage</td>
                    <td>AWS SDK</td>
                </tr>
                <tr>
                    <td><strong>Stripe</strong></td>
                    <td>Payment processing</td>
                    <td>REST API + Webhooks</td>
                </tr>
                <tr>
                    <td><strong>Truv</strong></td>
                    <td>Income/asset verification</td>
                    <td>REST API + Webhooks</td>
                </tr>
                <tr>
                    <td><strong>Monday.com</strong></td>
                    <td>CRM & workflow management</td>
                    <td>REST API</td>
                </tr>
                <tr>
                    <td><strong>Make.com</strong></td>
                    <td>Automation & data sync</td>
                    <td>Webhooks</td>
                </tr>
            </tbody>
        </table>

        <h3>Webhook Endpoints</h3>
        <table>
            <thead>
                <tr>
                    <th>Webhook</th>
                    <th>Provider</th>
                    <th>Purpose</th>
                    <th>Route</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Stripe Webhook</td>
                    <td>Stripe</td>
                    <td>Payment confirmations</td>
                    <td><code>/api/stripe/webhook</code></td>
                </tr>
                <tr>
                    <td>Truv Orders</td>
                    <td>Truv</td>
                    <td>Verification status updates</td>
                    <td><code>/api/webhooks/truv-orders</code></td>
                </tr>
                <tr>
                    <td>Make.com</td>
                    <td>Make.com</td>
                    <td>Data synchronization</td>
                    <td><code>/api/webhooks/make</code></td>
                </tr>
            </tbody>
        </table>

        <h3>Security Considerations</h3>
        <ul>
            <li><strong>API Keys:</strong> All sensitive keys stored in Amplify environment variables</li>
            <li><strong>Webhooks:</strong> Validated using signature verification (Stripe) or JWT tokens (Truv)</li>
            <li><strong>CORS:</strong> Configured for specific domains only</li>
            <li><strong>Data Encryption:</strong> Sensitive data encrypted at rest and in transit</li>
        </ul>



        <hr style="margin: 3rem 0; border: none; border-top: 2px solid #e5e7eb;">

        <div style="text-align: center; color: #6b7280; font-size: 0.875rem;">
            <p><strong>Document Version:</strong> 1.0</p>
            <p><strong>Last Updated:</strong> February 3, 2026</p>
            <p><strong>Maintained By:</strong> Development Team</p>
        </div>
    </div>
</body>

</html>